## Small CRM v3.0 User Login Panel Authentication Bypass via SQL Injection
#### Exploited Author: Manab Jyoti Dowarah
#### Vendors Contact page: https://phpgurukul.com
#### Software Link: https://phpgurukul.com/small-crm-php/
#### Version: 3.0
#### Tested on: XAMPP Server
#### Finding Date: 28/11/2023

#### Description:
Small CRM 3.0 is vulnerable to SQL Injection on it's Users login panel because of "password" parameter is directly used in the SQL query without any sanitization and the SQL Injection payload being executed. </br>
An attacker can able to access the Users login panel and supply the malicious payload, successfully taking over users account. Basically a successful SQL injection exploit can read sensitive data from the database, modify database data, execute administration operations on the database, recover the content of a given file present on the DBMS file system and in some cases issue commands to the operating system.

#### Detailed steps to reproduce:
1. I have Hosted Small CRM v3.0 in local XAMPP Server.
2. After completing the setup, go to the user login panel: http://localhost/SMALL_CRM/crm/login.php
   
   <img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/3.JPG" style="width:700px; height:440px;">
   
3. Payload:
   ```' OR ''='```
4. Insert a any random email id in "Email" parameter.
   
   <img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/2.JPG" style="width:600px; height:440px;">
   
5. Then, in the "Password" parameter, execute the above SQL payload.
   
   <img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/4.JPG" style="width:700px; height:440px;">
   
6. Login authentication Successfully done via SQL injection
   
    <img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/5.JPG" style="width:800px; height:400px;">

7. Database dump:
   
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/6.JPG" style="width:800px; height:400px;">

<img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/7.JPG" style="width:900px; height:250px;">

#### Impact:
An attacker can use this vulnerability to bypass the login authentication and fetch data from the database, then further dump the database.

#### Mitigation:
It is recommended:
1. Use the parameterized queries with stored procedure in the application for all SQL queries.
2. Sanitize the data before storing to the database, prefer using of character encoding.
3. Double up any single quotation marks appearing within user input before incorporating that input into a SQL query.

            
