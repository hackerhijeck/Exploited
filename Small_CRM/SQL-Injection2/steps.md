## SQL Injection in Small CRM v3.0 Admin's Users functionality of "id" parameter
#### Exploited Author: Manab Jyoti Dowarah
#### Vendors Contact page: https://phpgurukul.com
#### Software Link: https://phpgurukul.com/small-crm-php/
#### Version: 3.0
#### Tested on: XAMPP Server
#### Finding Date: 14/12/2023

#### Description:
It was observed that the Small CRM v3.0 Admin Users functionality of "id" parameter is vulnerable to SQL Injection. </br>
An attacker can able to access the Users login panel and supply the malicious payload, successfully taking over users account. Basically a successful SQL injection exploit can read sensitive data from the database, modify database data, execute administration operations on the database, recover the content of a given file present on the DBMS file system and in some cases issue commands to the operating system.

#### Detailed steps to reproduce:
1. I have Hosted Small CRM v3.0 in local XAMPP Server.
2. After completing the setup, go to the admin login panel and logged in with default credentials. (http://localhost/SMALL_CRM/crm/admin/)
   
   <img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/SQL-Injection2/login.JPG" style="width:700px; height:440px;">
   
3. Go to the "Users" functionality and click any users View in Edit. (http://localhost/SMALL_CRM/crm/admin/edit-user.php?id=3)
4. The Users functionality of "id" parameter is vunerable to SQL Injection.
5. After inserting a single quotation ' in id parameter, a sql error disclosed.
   
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/SQL-Injection2/error.JPG" style="width:800px; height:400px;">
7. Using SQLmap to dump the databases:
   
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/SQL-Injection2/1.JPG" style="width:800px; height:400px;">

<img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/SQL-Injection2/2.JPG" style="width:800px; height:400px;">

<img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/SQL-Injection2/3.JPG" style="width:800px; height:400px;">

<img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/SQL-Injection2/4.JPG" style="width:800px; height:400px;">

<img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/SQL-Injection2/5.JPG" style="width:800px; height:400px;">

<img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/SQL-Injection2/6.JPG" style="width:800px; height:400px;">

<img src="https://github.com/hackerhijeck/Exploited/blob/main/Small_CRM/SQL-Injection2/7.JPG" style="width:800px; height:400px;">

#### Impact:
An attacker can use this vulnerability to bypass the login authentication and fetch data from the database, then further dump the database.

#### Mitigation:
It is recommended:
1. Use the parameterized queries with stored procedure in the application for all SQL queries.
2. Sanitize the data before storing to the database, prefer using of character encoding.
3. Double up any single quotation marks appearing within user input before incorporating that input into a SQL query.

            
