## Art Gallery Management System v1.1 Unauthorized Blind XSS to Admin Account Takeover
#### Exploited Author: Manab Jyoti Dowarah
#### Vendors: PHPgurukul (https://phpgurukul.com)
#### Product Link: https://phpgurukul.com/art-gallery-management-system-using-php-and-mysql/
#### Version: v1.1
#### Tested on: XAMPP Server
#### Finding Date: 01/02/2024

#### Description:
It was observed that the Art Gallery Management System v1.1 includes an Art Enquiry functionality, which is vulnerable to Unauthorized Blind XSS to Admin Account Takeover.</br>
The Blind XSS occurs when an attacker is able to inject malicious scripts into a web application, and the payload is executed by a victim who views a particular resource without the attacker directly observing the results. Unlike traditional Cross-Site Scripting (XSS) attacks, where the attacker may immediately see the effects of the injected script, blind XSS attacks involve delayed or indirect exploitation.

#### Detailed steps to reproduce:
1. The Hosted Art Gallery Management System v1.1 is currently running on a local XAMPP Server.
2. The application includes an Art Enquiry functionality, which is vulnerable to Unauthorized Blind Cross-Site Scripting, potentially leading to an Admin Account Takeover.
3. In the following screenshots, a blind XSS payload injected with "name" and "message" parameters into the inquiry form and subsequently submitted by accessing the URL (http://localhost/agmsdb/agms/art-enquiry.php?eid=5).</br>
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Art_Gallary/Blind_XSS/1.JPG" style="width:600px; height:400px;">
</br>
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Art_Gallary/Blind_XSS/2.JPG" style="width:750px; height:400px;">
4. The provided screenshot demonstrates with the (victim) admin account.</br>
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Art_Gallary/Blind_XSS/3.JPG" style="width:720px; height:400px;">
5. The below screenshots confirm that the attacker's inquiry was submitted, along with the details. (as an admin)</br>
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Art_Gallary/Blind_XSS/4.JPG" style="width:720px; height:400px;">
</br>
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Art_Gallary/Blind_XSS/5.JPG" style="width:720px; height:400px;">
6. Upon the admin attempt to view or open the attacker's enquiry to check the details, the blind XSS payload will be triggered or execute.</br>
7. The screenshot below shows the Blind XSS (BXSS) dashboard.</br>
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Art_Gallary/Blind_XSS/6.JPG" style="width:700px; height:400px;">
8. This screenshot belong to the attacker's browser.</br>
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Art_Gallary/Blind_XSS/7.JPG" style="width:600px; height:400px;">
9. The below screenshots show changing the attacker cookie value to the admin's cookies, which found from the BXSS.</br>
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Art_Gallary/Blind_XSS/8.JPG" style="width:800px; height:400px;">
</b>
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Art_Gallary/Blind_XSS/9.JPG" style="width:800px; height:400px;">
</br>
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Art_Gallary/Blind_XSS/10.JPG" style="width:900px; height:300px;">
10. The final screenshot demonstrates the successful takeover of the admin account via Blind XSS.</br>
<img src="https://github.com/hackerhijeck/Exploited/blob/main/Art_Gallary/Blind_XSS/11.JPG" style="width:810px; height:400px;">

#### Impact:
An attacker can inject a blind XSS payload to perform unauthorized actions, such as stealing the adminâ€™s session tokens, account takeover, performing arbitrary actions on their behalf, and logging their keystrokes.

#### Mitigation:
* All user entry points in the application should be properly validated or sanitized, the validation mechanism must be implemented on both client and server side of the application.
* Implement content security policy in the application.
